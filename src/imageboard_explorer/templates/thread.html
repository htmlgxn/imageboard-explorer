{% extends "layout.html" %}

{% block content %}
  <section class="thread">
    <div class="thread-header">/{{ board }}/</div>
    {% if error %}
      <div class="error-panel">{{ error }}</div>
    {% else %}
      <div class="list-window">
        <div class="post-list">
          {% for post in posts %}
            <article
              class="post-card selectable {% if post.no == selected %}selected{% endif %}"
              data-post-id="{{ post.no }}"
              data-quotes-header="{{ post.quotes_header | join(',') }}"
              data-quotes-body="{{ post.quotes_body | join(',') }}"
              {% if post.image_view_href %}data-href="{{ post.image_view_href }}"{% endif %}
            >
              <div class="post-thumb">
                {% if post.thumbnail_url %}
                  <img src="{{ post.thumbnail_url }}" alt="thumbnail" referrerpolicy="no-referrer">
                {% else %}
                  <img src="/static/img/placeholder.svg" alt="placeholder" referrerpolicy="no-referrer">
                {% endif %}
              </div>
              <div class="post-body">
              <div class="post-meta">
                <span class="post-name">{{ post.name }}</span>
                {% if post.country_flag_url %}
                  <img class="country-flag" src="{{ post.country_flag_url }}" alt="{{ post.country_name or post.country }}" title="{{ post.country_name or post.country }}" referrerpolicy="no-referrer">
                {% endif %}
                <span class="post-now">{{ post.now }}</span>
                <span class="post-no">No.{{ post.no }}</span>
                {% if post.reply_from %}
                    <span class="reply-from">
                      {% for reply_id in post.reply_from %}
                      <span class="nav-link link-quote reply-from-link" data-quote-id="{{ reply_id }}">&gt;&gt;{{ reply_id }}</span>
                      {% endfor %}
                    </span>
                  {% endif %}
                </div>
                {% if post.quotes_header %}
                  <div class="quote-bar">
                    {% for quote_id in post.quotes_header %}
                      <span class="nav-link link-quote quote-header" data-quote-id="{{ quote_id }}">&gt;&gt;{{ quote_id }}</span>
                    {% endfor %}
                  </div>
                {% endif %}
                <div class="post-text">{{ post.comment_html | safe }}</div>
              </div>
            </article>
          {% endfor %}
        </div>
      </div>
    {% endif %}
  </section>
{% endblock %}

{% block status %}
  <span class="status-item"><span class="key">h</span><span class="label">home</span></span>
  <span class="status-item"><span class="key">↑/↓</span><span class="label">move</span></span>
  <span class="status-item"><span class="key">enter</span><span class="label">open post / image</span></span>
  <span class="status-item"><span class="key">backspace</span><span class="label">back</span></span>
  <span class="status-item"><span class="key">WASD</span><span class="label">select link</span></span>
  <span class="status-item"><span class="key">e</span><span class="label">open link</span></span>
{% endblock %}
